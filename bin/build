#!/usr/bin/env coffee

{include} = require "fairmont"
{rmrf,log,run} = require "../src/operators"

Tasks = 
  
  # TODO: each tasks module should add a clean function
  clean: ->
    log "Cleaning Web client build directories"
    rmrf( "build" )
    rmrf( "src/web/ark/node_modules" )
    
  # TODO: each tasks module should add a function to be 
  # called here, if necessary - but now order matters ... or
  # is that already in the tasks themselves? Ex: the ark
  # task should really be calling the npm task?
  all: (name) ->
    log "Building the Web client (doesn't include clean)"
    run @npm, @sync, (=> @config( name ) ), @ark, @html, @css

include Tasks, require("../src/tasks/sync")
include Tasks, require("../src/tasks/ark")
include Tasks, require("../src/tasks/html")
include Tasks, require("../src/tasks/css")

[_,_,name,args...] = process.argv
Tasks[name]?(args...)

